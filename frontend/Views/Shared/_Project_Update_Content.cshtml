@using System.Configuration
@model update
@{
    bool isadmin = User.IsInRole("admin") || ViewBag.UserID == Model.UserID ;
    bool isauthenticated = User.Identity.IsAuthenticated;
}
<div class='single-update-body'>
    @foreach (update_content content in Model.update_content)
    {
        { Html.RenderPartial("_Update_Content", content); }
    }
    <div class='comments-container'>
        <a name="comments-@Model.UpdateID" id="comments" ></a>
        <h4>
            Comments</h4>
        @foreach (var item in Model.update_comment.OrderByDescending(x => x.CommentID))
        {
            <div class="comment-single-entry">
                <div>
                    from: @item.user.UserName</div>
                <div>
                    date: @item.Date</div>
                <div>@item.Text</div>
                <div><img src="@item.Picture" /></div>
                @if (isadmin || ViewBag.UserID == item.UserID)
                {
                    <div class="admin">
                        @using (Html.BeginForm("CommentDelete", "Projects"))
                        {
                            <input type="hidden" name="CommentID" value="@item.CommentID"/>
                            <input type="hidden" name="ProjectID" value="@Model.ProjectID"/>
                            <input type="submit" value="delete" class="btn"/>
                        }
                    </div>
                }
            </div>
        }
        @if (isauthenticated)
        {
            Html.RenderPartial("_Form_Comment",Model);
        }else {
            <div>To post comments on the Project you need to register or login.</div>
        }
    </div>
</div>
